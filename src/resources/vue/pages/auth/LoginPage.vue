<script setup lang="ts">
  import { reactive } from 'vue'
  import { BaseInput, BaseButton } from '@/components/Base'
  import { SVGAnimateSpin } from '@/components/SVG'
  import type { UserLoginCredential } from '@/api/models'
  import { authLogin } from '@/api/queries/auth.query'

  const { isLoading, mutateAsync } = authLogin()

  const form = reactive<UserLoginCredential>({
    email: null,
    password: null,
    errors: {}
  })

  const handleSubmit = (): void => {
    form.errors = {}
    mutateAsync(form)
      .then(() => window.location.reload())
      .catch((error) => {
        const errors = error?.response?.data?.errors
        if (errors) {
          form.errors = errors
        }
      })
  }
</script>

<template>
  <div
    class="flex justify-center justify-items-center bg-slate-500 w-full min-h-screen"
  >
    <div class="max-w-sm bg-white my-auto p-8 w-full border rounded-sm">
      <div class="py-4 pb-8">
        <svg
          class="max-h-12"
          width="100%"
          height="100%"
          viewBox="0 0 207 61"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M1.992 23V6.2H5.208L12.36 18.056H10.656L17.688 6.2H20.88L20.928 23H17.28L17.256 11.792H17.928L12.312 21.224H10.56L4.824 11.792H5.64V23H1.992ZM23.9299 23L31.6099 6.2H33.3619L41.0419 23H39.1699L32.1139 7.232H32.8339L25.7779 23H23.9299ZM26.9539 18.512L27.4819 17.072H37.2499L37.7779 18.512H26.9539ZM44.781 23V6.2H51.069C52.493 6.2 53.717 6.432 54.741 6.896C55.765 7.344 56.549 8 57.093 8.864C57.653 9.712 57.933 10.744 57.933 11.96C57.933 13.144 57.653 14.168 57.093 15.032C56.549 15.88 55.765 16.536 54.741 17C53.717 17.448 52.493 17.672 51.069 17.672H45.765L46.557 16.856V23H44.781ZM56.253 23L51.933 16.904H53.853L58.197 23H56.253ZM46.557 17L45.765 16.16H51.021C52.701 16.16 53.973 15.792 54.837 15.056C55.717 14.32 56.157 13.288 56.157 11.96C56.157 10.616 55.717 9.576 54.837 8.84C53.973 8.104 52.701 7.736 51.021 7.736H45.765L46.557 6.896V17ZM64.6208 18.824L64.5488 16.664L74.7248 6.2H76.7648L69.3488 13.976L68.3408 15.056L64.6208 18.824ZM63.0848 23V6.2H64.8608V23H63.0848ZM75.1568 23L67.9088 14.648L69.1088 13.352L77.2688 23H75.1568ZM88.1201 23V6.2H91.3361L98.4881 18.056H96.7841L103.816 6.2H107.008L107.056 23H103.408L103.384 11.792H104.056L98.4401 21.224H96.6881L90.9521 11.792H91.7681V23H88.1201ZM110.058 23L117.738 6.2H119.49L127.17 23H125.298L118.242 7.232H118.962L111.906 23H110.058ZM113.082 18.512L113.61 17.072H123.378L123.906 18.512H113.082ZM130.909 23V6.2H137.197C138.621 6.2 139.845 6.432 140.869 6.896C141.893 7.344 142.677 8 143.221 8.864C143.781 9.712 144.061 10.744 144.061 11.96C144.061 13.144 143.781 14.168 143.221 15.032C142.677 15.88 141.893 16.536 140.869 17C139.845 17.448 138.621 17.672 137.197 17.672H131.893L132.685 16.856V23H130.909ZM142.381 23L138.061 16.904H139.981L144.325 23H142.381ZM132.685 17L131.893 16.16H137.149C138.829 16.16 140.101 15.792 140.965 15.056C141.845 14.32 142.285 13.288 142.285 11.96C142.285 10.616 141.845 9.576 140.965 8.84C140.101 8.104 138.829 7.736 137.149 7.736H131.893L132.685 6.896V17ZM149.213 23V6.2H150.989V23H149.213ZM157.415 23V6.2H159.191V21.464H168.599V23H157.415ZM169.82 23L177.5 6.2H179.252L186.932 23H185.06L178.004 7.232H178.724L171.668 23H169.82ZM172.844 18.512L173.372 17.072H183.14L183.668 18.512H172.844ZM197.805 23.144C196.525 23.144 195.341 22.936 194.253 22.52C193.181 22.088 192.245 21.488 191.445 20.72C190.661 19.952 190.045 19.048 189.597 18.008C189.165 16.968 188.949 15.832 188.949 14.6C188.949 13.368 189.165 12.232 189.597 11.192C190.045 10.152 190.669 9.248 191.469 8.48C192.269 7.712 193.205 7.12 194.277 6.704C195.365 6.272 196.549 6.056 197.829 6.056C199.109 6.056 200.277 6.256 201.333 6.656C202.405 7.056 203.317 7.664 204.069 8.48L202.965 9.608C202.261 8.904 201.485 8.4 200.637 8.096C199.789 7.792 198.877 7.64 197.901 7.64C196.861 7.64 195.901 7.816 195.021 8.168C194.157 8.504 193.397 8.992 192.741 9.632C192.101 10.256 191.597 10.992 191.229 11.84C190.877 12.672 190.701 13.592 190.701 14.6C190.701 15.592 190.877 16.512 191.229 17.36C191.597 18.208 192.101 18.952 192.741 19.592C193.397 20.216 194.157 20.704 195.021 21.056C195.901 21.392 196.853 21.56 197.877 21.56C198.837 21.56 199.741 21.416 200.589 21.128C201.453 20.84 202.245 20.352 202.965 19.664L203.973 21.008C203.173 21.712 202.237 22.248 201.165 22.616C200.093 22.968 198.973 23.144 197.805 23.144ZM202.269 20.792V14.6H203.973V21.008L202.269 20.792Z"
            fill="#4B5963"
          />
          <path
            d="M20.538 43.4L16.416 56H13.284L10.512 47.468L7.65 56H4.536L0.396 43.4H3.42L6.264 52.256L9.234 43.4H11.934L14.814 52.328L17.748 43.4H20.538ZM35.1619 53.66V56H25.4059V43.4H34.9279V45.74H28.3039V48.476H34.1539V50.744H28.3039V53.66H35.1619ZM49.974 49.448C50.694 49.676 51.258 50.06 51.666 50.6C52.074 51.128 52.278 51.782 52.278 52.562C52.278 53.666 51.846 54.518 50.982 55.118C50.13 55.706 48.882 56 47.238 56H40.722V43.4H46.878C48.414 43.4 49.59 43.694 50.406 44.282C51.234 44.87 51.648 45.668 51.648 46.676C51.648 47.288 51.498 47.834 51.198 48.314C50.91 48.794 50.502 49.172 49.974 49.448ZM43.62 45.596V48.566H46.518C47.238 48.566 47.784 48.44 48.156 48.188C48.528 47.936 48.714 47.564 48.714 47.072C48.714 46.58 48.528 46.214 48.156 45.974C47.784 45.722 47.238 45.596 46.518 45.596H43.62ZM47.022 53.804C47.79 53.804 48.366 53.678 48.75 53.426C49.146 53.174 49.344 52.784 49.344 52.256C49.344 51.212 48.57 50.69 47.022 50.69H43.62V53.804H47.022ZM66.0634 43.4H71.7874C73.1554 43.4 74.3614 43.664 75.4054 44.192C76.4614 44.708 77.2774 45.44 77.8534 46.388C78.4414 47.336 78.7354 48.44 78.7354 49.7C78.7354 50.96 78.4414 52.064 77.8534 53.012C77.2774 53.96 76.4614 54.698 75.4054 55.226C74.3614 55.742 73.1554 56 71.7874 56H66.0634V43.4ZM71.6434 53.606C72.9034 53.606 73.9054 53.258 74.6494 52.562C75.4054 51.854 75.7834 50.9 75.7834 49.7C75.7834 48.5 75.4054 47.552 74.6494 46.856C73.9054 46.148 72.9034 45.794 71.6434 45.794H68.9794V53.606H71.6434ZM93.9305 53.66V56H84.1745V43.4H93.6965V45.74H87.0725V48.476H92.9225V50.744H87.0725V53.66H93.9305ZM111.429 43.4L105.975 56H103.095L97.6589 43.4H100.809L104.643 52.4L108.531 43.4H111.429ZM125.477 53.66V56H115.721V43.4H125.243V45.74H118.619V48.476H124.469V50.744H118.619V53.66H125.477ZM131.037 43.4H133.953V53.624H140.271V56H131.037V43.4ZM151.031 56.216C149.723 56.216 148.541 55.934 147.485 55.37C146.441 54.806 145.619 54.032 145.019 53.048C144.431 52.052 144.137 50.936 144.137 49.7C144.137 48.464 144.431 47.354 145.019 46.37C145.619 45.374 146.441 44.594 147.485 44.03C148.541 43.466 149.723 43.184 151.031 43.184C152.339 43.184 153.515 43.466 154.559 44.03C155.603 44.594 156.425 45.374 157.025 46.37C157.625 47.354 157.925 48.464 157.925 49.7C157.925 50.936 157.625 52.052 157.025 53.048C156.425 54.032 155.603 54.806 154.559 55.37C153.515 55.934 152.339 56.216 151.031 56.216ZM151.031 53.732C151.775 53.732 152.447 53.564 153.047 53.228C153.647 52.88 154.115 52.4 154.451 51.788C154.799 51.176 154.973 50.48 154.973 49.7C154.973 48.92 154.799 48.224 154.451 47.612C154.115 47 153.647 46.526 153.047 46.19C152.447 45.842 151.775 45.668 151.031 45.668C150.287 45.668 149.615 45.842 149.015 46.19C148.415 46.526 147.941 47 147.593 47.612C147.257 48.224 147.089 48.92 147.089 49.7C147.089 50.48 147.257 51.176 147.593 51.788C147.941 52.4 148.415 52.88 149.015 53.228C149.615 53.564 150.287 53.732 151.031 53.732ZM168.811 43.4C169.927 43.4 170.893 43.586 171.709 43.958C172.537 44.33 173.173 44.858 173.617 45.542C174.061 46.226 174.283 47.036 174.283 47.972C174.283 48.896 174.061 49.706 173.617 50.402C173.173 51.086 172.537 51.614 171.709 51.986C170.893 52.346 169.927 52.526 168.811 52.526H166.273V56H163.357V43.4H168.811ZM168.649 50.15C169.525 50.15 170.191 49.964 170.647 49.592C171.103 49.208 171.331 48.668 171.331 47.972C171.331 47.264 171.103 46.724 170.647 46.352C170.191 45.968 169.525 45.776 168.649 45.776H166.273V50.15H168.649ZM189.361 53.66V56H179.605V43.4H189.127V45.74H182.503V48.476H188.353V50.744H182.503V53.66H189.361ZM202.949 56L200.519 52.49H200.375H197.837V56H194.921V43.4H200.375C201.491 43.4 202.457 43.586 203.273 43.958C204.101 44.33 204.737 44.858 205.181 45.542C205.625 46.226 205.847 47.036 205.847 47.972C205.847 48.908 205.619 49.718 205.163 50.402C204.719 51.074 204.083 51.59 203.255 51.95L206.081 56H202.949ZM202.895 47.972C202.895 47.264 202.667 46.724 202.211 46.352C201.755 45.968 201.089 45.776 200.213 45.776H197.837V50.168H200.213C201.089 50.168 201.755 49.976 202.211 49.592C202.667 49.208 202.895 48.668 202.895 47.972Z"
            fill="#4B5963"
          />
          <rect y="32" width="207" height="4" fill="black" />
        </svg>
      </div>

      <form @submit.prevent="handleSubmit" class="pb-8">
        <div class="mb-4">
          <BaseInput
            v-model="form.email"
            type="email"
            required
            :error="form.errors?.email"
            v-model:clear="form.errors.email"
            placeholder="Email Address"
          />
        </div>

        <div class="mb-4">
          <BaseInput
            v-model="form.password"
            type="password"
            required
            :error="form.errors?.password"
            v-model:clear="form.errors.password"
            placeholder="Password"
          />
        </div>

        <BaseButton type="submit" class="bg-black text-white py-4">
          <span class="flex justify-center items-center">
            <SVGAnimateSpin v-if="isLoading" />
            <span :class="{ 'ml-3': isLoading }">Login</span>
          </span>
        </BaseButton>
      </form>
    </div>
  </div>
</template>
